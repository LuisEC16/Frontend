<div class="transactions-container">
  <!-- 🔹 Título -->
  <h2>🔎 Auditoría de Transacciones</h2>

  <!-- 🔹 Filtros -->
  <div class="filters">
      <label for="date">📅 Fecha:</label>
      <input type="date" id="date" [(ngModel)]="filters.date">

      <label for="status">🟢 Estado:</label>
      <select id="status" [(ngModel)]="filters.status">
          <option value="">Todos</option>
          <option value="approved">Aprobado</option>
          <option value="pending">Pendiente</option>
          <option value="rejected">Rechazado</option>
      </select>

      <label for="method">💳 Método de Pago:</label>
      <select id="method" [(ngModel)]="filters.method">
          <option value="">Todos</option>
          <option value="credit_card">Tarjeta</option>
          <option value="bank_transfer">Transferencia</option>
      </select>

      <button (click)="applyFilters()" class="apply-btn">🔍 Aplicar Filtros</button>
  </div>

  <!-- 🔹 Tabla de transacciones -->
  <table class="transactions-table">
      <thead>
          <tr>
              <th>ID</th>
              <th>Tipo</th>
              <th>Monto</th>
              <th>Estado</th>
              <th>Método</th>
              <th>Fecha</th>
              <th>Acciones</th> <!-- ✅ Agregado para validar/eliminar transacciones -->
          </tr>
      </thead>
      <tbody>
          <tr *ngFor="let transaction of transactions">
              <td>{{ transaction.id }}</td>
              <td>{{ transaction.type || 'N/A' }}</td>
              <td>{{ transaction.amount ? (transaction.amount | currency:'USD') : '-' }}</td> <!-- ✅ Evita error si `amount` es null -->
              <td [ngClass]="{
                  'pending': transaction.status === 'pending',
                  'approved': transaction.status === 'approved',
                  'rejected': transaction.status === 'rejected'
              }">
                  {{ transaction.status }}
              </td>
              <td>{{ transaction.payment_method || 'Desconocido' }}</td>
              <td>{{ transaction.created_at ? (transaction.created_at | date:'short') : '-' }}</td> <!-- ✅ Evita error si `created_at` es null -->
              <td>
                  <button *ngIf="transaction.status === 'pending'" (click)="validateTransaction(transaction.id, operadorId)" class="validate-btn">✅ Validar</button>
                  <button (click)="deleteTransaction(transaction.id)" class="delete-btn">🗑️ Eliminar</button>
              </td>
          </tr>
      </tbody>
  </table>

  <!-- 🔹 Exportar Transacciones -->
  <button (click)="exportTransactions()" class="export-btn">📥 Exportar CSV</button>
</div>
